@model IEnumerable<SmartLinks.Models.LinkVM>
@{
    ViewBag.Title = "Smart Links";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var pages = Model.Count() / 9 + 1;
}

<script src="~/Scripts/alllinks.js" type="text/javascript"></script>


<div class="form-group">
    <div class="content height-100">
        <div id="carousel-example-generic" class="carousel slide height-100" data-ride="carousel">
            <div class="carousel-inner lightbox" role="listbox">
                @for (var page = 0; page < pages; page++)
                {
                    if (page == 0)
                    {
                        <div class="item active">
                            <div class="row row-column row-column-first">
                                @foreach (var item in Model.Skip(page * 9).Take(9))
                                {
                                    <div class="col-md-4 col-xs-6 thumbnail thu-column">
                                        <a href="/SmartLinks/RedirectToLink?linkname=@item.LinkName" data-container="body" title="@item.Comment"  data-toggle="tooltip" >
                                            <img src="@item.Logo" class="img_src" />
                                        </a>
                                    </div>
                                }
                                @if (page == pages - 1 && pages * 9 - Model.Count() != 0)
                                {
                                    for (var def_img = 0; def_img < (pages * 9 - Model.Count()); def_img++)
                                    {
                                        <div class="col-md-4 col-xs-6 thumbnail thu-column">
                                            <a href="#" data-container="body">
                                                <img class="img_default"/>
                                            </a>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="item">
                            <div class="row row-column row-column-first">
                                @foreach (var item in Model.Skip(page * 9).Take(9))
                                {
                                    <div class="col-md-4 col-xs-6 thumbnail thu-column">
                                        <a href="/SmartLinks/RedirectToLink?linkname=@item.LinkName" data-container="body" title="@item.Comment"  data-toggle="tooltip">
                                            <img src="@item.Logo" class="img_src" />
                                        </a>
                                    </div>
                                }
                                @if (page == pages - 1 && pages * 9 - Model.Count() != 0)
                                {
                                    for (var def_img = 0; def_img < (pages * 9 - Model.Count()); def_img++)
                                    {
                                        <div class="col-md-4 col-xs-6 thumbnail thu-column">
                                            <a href="#" data-container="body"
                                               data-toggle="popover" data-placement="right"
                                               data-content="test">
                                                <span class="img_defualt"></span>
                                            </a>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    }
                }
            <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
</div>

<script type="text/javascript">
            $(function(){
                lightBox.init();
            })

            $('body').on('click', '.img_default', function () {
                $('.addLink').modal('show');
            });

</script>

</div>

<div class="modal fade addLink" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Custom Add Link</h4>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label>Link Name</label>
                        <input type="text" class="form-control" id="link_name" placeholder="Link Name"  data-val="true" data-val-length="The field must be a string with a minimum length of 2 and a maximum length of 100." data-val-length-max="100" data-val-length-min="2" data-val-regex="The field should not contain \'" data-val-regex-pattern="^(?!.*&#39;).*$" data-val-required="The Project field is required.">
                    </div>
                    <div class="form-group">
                        <label>Link</label>
                        <input type="text" class="form-control" id="link" placeholder="Link" data-val="true" data-val-length="The field must be a string with a minimum length of 2 and a maximum length of 1000." data-val-length-max="1000" data-val-length-min="2" data-val-required="The field is required."  data-val-regex="The field should not contain \'" data-val-regex-pattern="^(?!.*&#39;).*$">
                    </div>
                    <div class="form-group">
                        <label>Comment</label>
                        <textarea class="form-control" id="comment" rows="3"  data-val-length="The field must be a string with a minimum length of 2 and a maximum length of 200." data-val-length-max="200" data-val-length-min="2" data-val-required="The field is required." data-val-regex="The field should not contain \'" data-val-regex-pattern="^(?!.*&#39;).*$"></textarea>
                    </div>
                    <input type="hidden" id="imgurl" name="imgurl"/>
                    <div class="form-group">
                           <div class="row">
                            <div class="col-md-2">
                                <span class="btn btn-success btn-file" style="font-family:'Arial Narrow', arial" id="choosefile">
                                    <strong>Image Upload</strong><input type="file" name="files" id="file1" runat="server" onchange="ShowFileNames(this)" />
                                </span>
                            </div>
                            <div class="col-md-10">
                                <label class="control-label" id="showfilename" name="showfilename"></label>
                            </div>
                            <script type="text/javascript">
                                function ShowFileNames(oFile) {
                                    $.ajaxFileUpload
                                    (
                                        {
                                            url: '/userfiles/ImageUpload.ashx',
                                            secureuri: false,
                                            fileElementId: 'file1',
                                            dataType: 'HTML',
                                            success: function (data, status) {
                                                $('#imgurl').val(data);
                                                $('#modal_add_Link').removeAttr('disabled');
                                            },
                                            error: function (e) {
                                                window.alert("fail to upload image");
                                            }
                                        }
                                    );
                                    $('#showfilename').text(oFile.value);
                                }
                            </script>
                        </div>
                        
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="modal_add_Link">Add</button>
            </div>
        </div>
    </div>
</div>
